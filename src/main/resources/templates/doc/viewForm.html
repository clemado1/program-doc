<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head th:replace="fragments/doc_common :: docHead"><title></title></head>
<body>
<div th:replace="fragments/doc_common :: docBody"></div>
    <input th:id="docId" th:name="docId" th:value="${docId}" type="hidden">
    <h1 th:id="title" th:name="title"></h1>
    <div id="viewer">
        <strong>Loading...</strong>
    </div>
    <script>
        let docId = document.getElementById("docId").value;

        fetch(`/api/doc/view/${docId}`,{
            method: 'get',
            headers: {
                'content-type': 'application/json',
                'Authorization': 'Bearer ' + localStorage.getItem("jwt"),
            }
        }).then(res => res.json())
            .then(json => {
                console.log(json);
                document.getElementById("title").innerText = json.title;

                const Editor = toastui.Editor;
                const viewer = Editor.factory({
                    el: document.getElementById('viewer'),
                    viewer: true,
                    initialValue: json.contents
                });
            });
    </script>
</body>
</html>